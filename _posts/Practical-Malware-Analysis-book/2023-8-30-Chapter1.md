---
title: "Chapter 1 : Basic Static Analysis"
classes: wide
header:
  teaser: /assets/images/Practical-Malware-Analysis-book/CH-1/Lab-1/Cover.jpg
ribbon: Red
description: "Write up of the labs of chapter 1 in Practical Malware Analysis Book"
categories:
  - Practical Malware Analysis Book
toc: true
---

# Chapter 1 : Basic Static Analysis 

## 1- Lab 1-1
```
SHA256 Hash :-
Lab01-1.exe -> 58898bd42c5bd3bf9b1389f0eee5b39cd59180e8370eb9ea838a0b327bd6fe47
Lab01-1.dll -> f50e42c8dfaab649bde0398867e930b86c2a599e8db83b8260393082268f2dba
```
So first of all lets check both file in **VirusTotal** for Lab01-1.exe :- <br>
 * ![](/assets/images/Practical-Malware-Analysis-book/CH-1/Lab-1/1.png)<br>


Lab01-1.dll<br>

 * ![](/assets/images/Practical-Malware-Analysis-book/CH-1/Lab-1/2.png)<br>

As we can see both of them are malicious files.
Lets see the **strings** of Lab01-01.exe<br>
  *  ```
    CloseHandle
    UnmapViewOfFile
    IsBadReadPtr
    MapViewOfFile
    CreateFileMappingA
    CreateFileA
    FindClose
    FindNextFileA
    FindFirstFileA
    CopyFileA
    KERNEL32.dll
    malloc
    exit
    MSVCRT.dll
    kerne132.dll
    kernel32.dll
    .exe
    C:\*
    C:\windows\system32\kerne132.dll
    Kernel32.
    Lab01-01.dll
    C:\Windows\System32\Kernel32.dll
    ```<br>
  * The strings aren't much but is enough for exe to work 
  * From the imports of KERNEL32.dll (CreateFileA, FindClose, FindNextFileA, FindFirstFileA, CopyFileA) looks like it is copies files and searching for files

**strings** of Lab01-1.dll :-<br>
  * ```CloseHandle
    Sleep
    CreateProcessA
    CreateMutexA
    OpenMutexA
    KERNEL32.dll
    WS2_32.dll
    strncmp
    MSVCRT.dll
    exec
    sleep
    hello
    127.26.152.13
    ```<br>
  * From the imports of KERNEL32.dll **(Sleep, CreateProcessA)** :- 
      - looks like it creates a process 
      - sleep at specific point 
  * From WS2_32.dll (Socket, WSAStartup, inet_addr, connect, send, shutdown, recv, closesocket, WSACleanup, htons)
    - Looks it is creating a socket connection and data is send and received

### Host-based indicators
We can see in Lab01-1.exe **C:\windows\system32\kerne132.dll** the malware trying to trick us by changing "L" in kernel to "1"

### Network indicators 
We can see in Lab01-1.dll **127.26.152.13** looks like it is going to create socket connection to this IP addr

### Packed or Not?!
By using DIE :- 
  * Lab01-1.exe<br>
    * ![](/assets/images/Practical-Malware-Analysis-book/CH-1/Lab-1/3.png)<br>
  * Lab01-1.dll<br>
    * ![](/assets/images/Practical-Malware-Analysis-book/CH-1/Lab-1/4.png)<br>
So it is Not Packed

### Questions
- Upload the files to http://www.VirusTotal.com/ and view the reports. Does either file match any existing antivirus signatures?

  - Both of them are Malicious as we saw above in the analysis

- When were these files compiled?

  - By using PE-Studio
    - Lab01-1.exe -> compiler-stamp,Sun Dec 19 16:16:19 2010
    - Lab01-1.exe -> compiler-stamp,Sun Dec 19 16:16:38 2010
    - Less than 1 min difference which indicates it is made by the same author

- Are there any indications that either of these files is packed or obfuscated? If so, what are these indicators?

  - The strings found aren't much but it enough and they are not obfuscated as seen above
  - Also as seen Above using DIE also you can use PeId

- Do any imports hint at what this malware does? If so, which imports are they?
  
  - Lab01-1.exe
    - From the imports of KERNEL32.dll (CreateFileA, FindClose, FindNextFileA, FindFirstFileA, CopyFileA) looks like it is copies files and searching for files
  - Lab01-1.dll
    - From the imports of KERNEL32.dll (Sleep, CreateProcessA) :- 
      - looks like it creates a process 
      - sleep at specific point 
    - From WS2_32.dll (Socket, WSAStartup, inet_addr, connect, send, shutdown, recv, closesocket, WSACleanup, htons)
      - Looks it is creating a socket connection and data is send and received

- Are there any other files or host-based indicators that you could look for on infected systems?
  
  - C:\windows\system32\kerne132.dll

- What network-based indicators could be used to find this malware on infected machines?
  
  - 127.26.152.13

- What would you guess is the purpose of these files?
  - The .exe is used for searching and coping files also I think it will execute the .dll which is a backdoor as the combination of socket connection with Sleep, CreateProcessA are used at backdoor.